---
- hosts: all
  vars:
    ansible_winrm_server_cert_validation: ignore
    pdc_administrator_password: ansible_password
  pre_tasks:
    - name: Firewall rule to allow RDP on TCP port 3389
      community.windows.win_firewall_rule:
        name: Remote Desktop
        localport: 3389
        action: allow
        direction: in
        protocol: tcp
        profiles: [Domain, Public, Private]
        state: present
        enabled: yes
    - name: Install Remote-Desktop-Services with sub features and management tools
      ansible.windows.win_feature:
        name: Remote-Desktop-Services
        state: present
        include_sub_features: yes
        include_management_tools: yes
      register: install_remote_desktop_services
    - debug: var=install_remote_desktop_services
  roles:
    - justin_p.pdc
